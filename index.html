<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solana Web App</title>
    <style>
        body {
            text-align: center;
            margin-top: 100px;
            background-image: url('images/background.jpg'); /* Ensure this path is correct */
            background-size: cover; /* Make the background image cover the whole area */
            color: orange; /* Change text color to orange */
            font-size: 24px; /* Increase font size */
        }
        button {
            padding: 10px 20px;
            font-size: 20px; /* Slightly increase button font size */
            margin: 5px;
        }
        #result {
            font-size: 28px; /* Increase result font size */
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Solana Web App</h1>
    <button id="connectButton">Connect Wallet</button>
    <button id="playButton" style="display: none;">Play Game</button>
    <div id="result"></div>

    <script src="https://cdn.jsdelivr.net/npm/@solana/web3.js@1.68.0/lib/index.js"></script>
    <script>
        let userWallet;

        async function connectWallet() {
            if (window.solana && window.solana.isPhantom) {
                try {
                    const response = await window.solana.connect();
                    userWallet = response.publicKey.toString();
                    document.getElementById("connectButton").innerText = "Connected";
                    document.getElementById("playButton").style.display = 'block';
                } catch (err) {
                    console.error("Connection failed:", err);
                }
            } else {
                alert("Phantom wallet not found. Please install it.");
            }
        }

        async function transferSol(toWallet, amount) {
            const connection = new solanaWeb3.Connection(solanaWeb3.clusterApiUrl('mainnet-beta'), 'confirmed');
            const transaction = new solanaWeb3.Transaction().add(
                solanaWeb3.SystemProgram.transfer({
                    fromPubkey: new solanaWeb3.PublicKey(userWallet),
                    toPubkey: new solanaWeb3.PublicKey(toWallet),
                    lamports: amount,
                })
            );

            const { blockhash } = await connection.getLatestBlockhash();
            transaction.recentBlockhash = blockhash;
            transaction.feePayer = new solanaWeb3.PublicKey(userWallet);

            // Sign and send the transaction
            try {
                const signedTransaction = await window.solana.signTransaction(transaction);
                const signature = await connection.sendRawTransaction(signedTransaction.serialize());
                await connection.confirmTransaction(signature);
                document.getElementById("result").innerText = "Transfer successful: " + signature;
            } catch (error) {
                console.error("Transaction failed:", error);
                document.getElementById("result").innerText = "Transaction failed: " + error.message;
            }
        }

        document.getElementById('connectButton').addEventListener('click', connectWallet);

        // Example: Calling transferSol when the "Play Game" button is clicked
        document.getElementById('playButton').addEventListener('click', function () {
            const amount = 1000000000; // Amount in lamports (1 SOL = 1,000,000,000 lamports)
            const toWallet = "BvKeWCU3nsfW5VpzKhMd7atD5i5qeEQ2ga2t5coDagNr"; // Replace with the actual wallet address
            transferSol(toWallet, amount);
        });
    </script>
</body>
</html>
